#include "sl_bsp.h"#include <fcntl.h>#include <silan_resources.h>#include <silan_addrspace.h>#include <stdio.h>#include <string.h>#include <sys/time.h>#include <zhuque_bsp_gpio.h>#include "sl_ui_cmd.h"bool is_power_on_unmute = false;extern bool frist_hdmi_init;const unsigned char led_pin_tab[] ={LED_OPT_PIN, LED_AUX_PIN, LED_BT_PIN, LED_RCA_PIN, LED_HDMI_PIN};void print_pad_reg(void){	int value=0xffff;	printf("%s \n", __func__);	value = REG32(KSEG1(SILAN_PADMUX_CTRL));	printf("SILAN_PADMUX_CTRL----int=0x%x\n", value);	value = REG32(KSEG1(SILAN_PADMUX_CTRL2));	printf("SILAN_PADMUX_CTRL2----int=0x%x\n", value);}void set_pad_spdif(void){	int value = REG32(KSEG1(SILAN_PADMUX_CTRL));	value &= ~(1 << SILAN_PADMUX_SPDIF);	REG32(KSEG1(SILAN_PADMUX_CTRL)) = value;	}void pad_mux_init(void){	int value=0xffff;	REG32(KSEG1(SILAN_PADMUX_CTRL)) = 0;	REG32(KSEG1(SILAN_PADMUX_CTRL2)) = 0;	value = REG32(KSEG1(SILAN_PADMUX_CTRL));	printf("SILAN_PADMUX_CTRL----int=0x%x\n", value);	value = REG32(KSEG1(SILAN_PADMUX_CTRL2));	printf("SILAN_PADMUX_CTRL2----int=0x%x\n", value);	//REG1/////////////////////////////////////////////////////	//UART2 debug	value = REG32(KSEG1(SILAN_PADMUX_CTRL));	value |= (1 << SILAN_PADMUX_UART2);	//IIS----IN	value |= (1 << SILAN_PADMUX_IISADC);	//IIS----OUT	value |= (1 << SILAN_PADMUX_IISDAC);	value |= (1 << SILAN_PADMUX_IISDAC_FD0);	//spdif	value |= (1 << SILAN_PADMUX_SPDIF_IN0);	value |= (1 << SILAN_PADMUX_SPDIF_IN2);	//hdmi	value |= (1 << SILAN_PADMUX_I2C2);	//uart1	//value |= (1 << SILAN_PADMUX_UART1);		REG32(KSEG1(SILAN_PADMUX_CTRL)) = value;	//REG2/////////////////////////////////////////////////////	value = REG32(KSEG1(SILAN_PADMUX_CTRL2));	value |= (1 << SILAN_PADMUX2_IISADC_FD2_CH2);	REG32(KSEG1(SILAN_PADMUX_CTRL2)) = value;    //gpio drive strength    //value = 0xaaaaaaaa; //8mA; 0x55555555: 4mA    REG32(KSEG1(SILAN_SYSTEM_CTL_REG17)) = 0xaaaa8000; //GPIO1_0 - GPIO1_6 iis脚设置最小电流    REG32(KSEG1(SILAN_SYSTEM_CTL_REG18)) = 0xaaaa8aaa; //GPIO1_22     REG32(KSEG1(SILAN_SYSTEM_CTL_REG19)) = 0xaaaaaaaa;	value = REG32(KSEG1(SILAN_PADMUX_CTRL));		printf("\npadmux :%x\n", value);	value = REG32(KSEG1(SILAN_PADMUX_CTRL2));	printf("padmux2 :%x\n", value);	frist_hdmi_init = true;	printf(">>>>>>>>>>>padmux initial 123... \n");}void bsp_led_io_init(int value){	int i;	int pin;	for(i = 0 ;i < sizeof(led_pin_tab); i++)	{		pin = led_pin_tab[i];		zhuque_bsp_gpio_set_mode(pin, GPIO_OUT, PUSH_PULL); 		zhuque_bsp_gpio_set_value(pin , value);	}}void set_iic_clk_freq(void){	(*(volatile unsigned int  *)(0xbe0a0014)) = 10000;	(*(volatile unsigned int  *)(0xbe0a0018)) = 10000;	}void bsp_init(void){	set_iic_clk_freq();	pad_mux_init();	//bt mute	zhuque_bsp_gpio_set_mode(HW_BT_MUTE_PIN, GPIO_IN, PULLING_HIGH); 	zhuque_bsp_gpio_set_value(HW_BT_MUTE_PIN, 1); 	//led pin	bsp_led_io_init(1);	//printf(">>>>>>>>>>>bsp initial ... \n");}void Hw_Amp_Mute(void){//	zhuque_bsp_gpio_set_mode(HW_MIC_MUTE_PIN, GPIO_OUT, PUSH_PULL); //	zhuque_bsp_gpio_set_value(HW_MIC_MUTE_PIN, 1); //	usleep(200000);//	zhuque_bsp_gpio_set_mode(HW_MUTE_PIN, GPIO_OUT, PUSH_PULL); //	zhuque_bsp_gpio_set_value(HW_MUTE_PIN, 0); }void Hw_Amp_UnMute(void){//	zhuque_bsp_gpio_set_mode(HW_MUTE_PIN, GPIO_OUT, PUSH_PULL); //	zhuque_bsp_gpio_set_value(HW_MUTE_PIN, 1);//	usleep(200000);//	zhuque_bsp_gpio_set_mode(HW_MIC_MUTE_PIN, GPIO_OUT, PUSH_PULL); //	zhuque_bsp_gpio_set_value(HW_MIC_MUTE_PIN, 0); }void Hw_PowerOn_UnMute(void){//	zhuque_bsp_gpio_set_mode(HW_MUTE_PIN, GPIO_OUT, PUSH_PULL); //	zhuque_bsp_gpio_set_value(HW_MUTE_PIN, 1);//	usleep(400000);//	zhuque_bsp_gpio_set_mode(HW_MIC_MUTE_PIN, GPIO_OUT, PUSH_PULL); //	zhuque_bsp_gpio_set_value(HW_MIC_MUTE_PIN, 0); }void Bt_Power_On(void){}void Bt_Power_Off(void){}void Bt_Mute(void){}void Bt_UnMute(void){}